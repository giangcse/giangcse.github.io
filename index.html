<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âm Lịch Việt Nam</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.7/lunar.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f6f8fc 0%, #e9f0f7 100%);
        }
        .date-picker {
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            -webkit-appearance: none;
            appearance: none;
            font-size: 16px;
            padding: 12px;
            border-radius: 12px;
        }
        .date-picker:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            outline: none;
        }
        .info-card {
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1), 0 5px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .quick-date-btn {
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }
        .quick-date-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }
        .quick-date-btn:active {
            transform: translateY(0);
        }
        .header-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .info-gradient {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }
        .detail-gradient {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        @media (max-width: 640px) {
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            .info-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">Âm Lịch Việt Nam</h1>
            <p class="text-base md:text-lg text-gray-600">Xem ngày âm lịch và thông tin chi tiết</p>
        </div>

        <!-- Chọn ngày -->
        <div class="mb-8">
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <!-- Hiển thị ngày hiện tại -->
                <div class="header-gradient text-white p-6">
                    <div class="text-center">
                        <h2 class="text-2xl font-semibold mb-2" id="currentDate"></h2>
                        <p class="text-lg opacity-90" id="currentDay"></p>
                    </div>
                </div>
<!-- Các nút chọn nhanh -->
<div class="grid grid-cols-3 gap-3 p-6 border-b border-gray-100">
    <button data-type="today" class="quick-date-btn text-gray-700 py-3 px-4 rounded-xl text-sm font-medium shadow-sm">
        Hôm nay
    </button>
    <button data-type="tomorrow"
        class="quick-date-btn text-gray-700 py-3 px-4 rounded-xl text-sm font-medium shadow-sm">
        Ngày mai
    </button>
    <button data-type="yesterday"
        class="quick-date-btn text-gray-700 py-3 px-4 rounded-xl text-sm font-medium shadow-sm">
        Hôm qua
    </button>
</div>
<!-- Date picker tùy chỉnh -->
<div class="p-6">
    <label class="block text-sm font-medium text-gray-700 mb-3">Hoặc chọn ngày khác:</label>
    <input type="date" id="datePicker" class="date-picker w-full">
                </div>
            </div>
            </div>

        <!-- Hiển thị thông tin âm lịch -->
        <div class="space-y-6">
            <div class="info-card bg-white rounded-2xl shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Thông tin âm lịch
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="info-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Ngày âm lịch:</p>
                        <p class="text-lg font-semibold text-gray-800" id="lunarDay"></p>
                    </div>
                    <div class="info-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Tháng âm lịch:</p>
                        <p class="text-lg font-semibold text-gray-800" id="lunarMonth"></p>
                    </div>
                    <div class="info-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Năm âm lịch:</p>
                        <p class="text-lg font-semibold text-gray-800" id="lunarYear"></p>
                    </div>
                </div>
            </div>

            <div class="info-card bg-white rounded-2xl shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Thông tin chi tiết
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="detail-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Can Chi:</p>
                        <p class="text-lg font-semibold text-gray-800" id="canChi"></p>
                    </div>
                    <div class="detail-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Tiết khí:</p>
                        <p class="text-lg font-semibold text-gray-800" id="tiet"></p>
                    </div>
                    <div class="detail-gradient p-4 rounded-xl">
                        <p class="text-sm text-gray-600 mb-2">Hoàng Đạo:</p>
                        <p class="text-lg font-semibold text-gray-800" id="hoangDao"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
                // Kiểm tra thư viện Lunar
                //console.log('Lunar library:', typeof Lunar);

                // Khởi tạo Telegram WebApp
                const tg = window.Telegram.WebApp;
                tg.expand();

                // Các mảng dữ liệu cơ bản
                const CAN = ['Giáp', 'Ất', 'Bính', 'Đinh', 'Mậu', 'Kỷ', 'Canh', 'Tân', 'Nhâm', 'Quý'];
                const CHI = ['Tý', 'Sửu', 'Dần', 'Mão', 'Thìn', 'Tỵ', 'Ngọ', 'Mùi', 'Thân', 'Dậu', 'Tuất', 'Hợi'];
                const DAYS = ['Chủ Nhật', 'Thứ Hai', 'Thứ Ba', 'Thứ Tư', 'Thứ Năm', 'Thứ Sáu', 'Thứ Bảy'];
                const TIET = ['Xuân phân', 'Thanh minh', 'Cốc vũ', 'Lập hạ', 'Tiểu mãn', 'Mang chủng', 'Hạ chí', 'Tiểu thử', 'Đại thử', 'Lập thu', 'Xử thử', 'Bạch lộ', 'Thu phân', 'Hàn lộ', 'Sương giáng', 'Lập đông', 'Tiểu tuyết', 'Đại tuyết', 'Đông chí', 'Tiểu hàn', 'Đại hàn', 'Lập xuân', 'Vũ thủy', 'Kinh trập'];
                const HOANG_DAO = ['Tý', 'Sửu', 'Dần', 'Mão', 'Thìn', 'Tỵ', 'Ngọ', 'Mùi', 'Thân', 'Dậu', 'Tuất', 'Hợi'];

                // Hàm định dạng ngày
                function formatDate(date) {
                    const day = date.getDate();
                    const month = date.getMonth() + 1;
                    const year = date.getFullYear();
                    return `${day} tháng ${month}, ${year}`;
            }

                // Hàm cập nhật hiển thị ngày hiện tại
                function updateCurrentDateDisplay(date) {
                    document.getElementById('currentDate').textContent = formatDate(date);
                    document.getElementById('currentDay').textContent = DAYS[date.getDay()];
                }

                // Hàm cập nhật thông tin âm lịch
                function updateLunarInfo(date) {
                    try {
                        const lunar = Lunar.fromDate(date);
                //console.log('Lunar date:', lunar);
            
                    // Cập nhật hiển thị ngày hiện tại
                    updateCurrentDateDisplay(date);
                
                    // Cập nhật thông tin cơ bản
                    document.getElementById('lunarDay').textContent = `${lunar.getDay()} tháng ${lunar.getMonth()} năm ${lunar.getYear()}`;
                    document.getElementById('lunarMonth').textContent = `Tháng ${lunar.getMonth()}`;
                    document.getElementById('lunarYear').textContent = `${CAN[lunar.getYearGanIndex()]} ${CHI[lunar.getYearZhiIndex()]}`;

                    // Cập nhật thông tin chi tiết
                    const canIndex = lunar.getYearGanIndex();
                    const chiIndex = lunar.getYearZhiIndex();
                    document.getElementById('canChi').textContent = `${CAN[canIndex]} ${CHI[chiIndex]}`;
                
                    const tietIndex = Math.floor((lunar.getDay() - 1) / 15);
                    document.getElementById('tiet').textContent = TIET[tietIndex];
                
                    const hoangDaoIndex = lunar.getDayZhiIndex();
                    document.getElementById('hoangDao').textContent = HOANG_DAO[hoangDaoIndex];
            } catch (error) {
                    //console.error('Error updating lunar info:', error);
                }
            }

                // Hàm xử lý chọn ngày nhanh
                function setDate(type) {
                    const today = new Date();
                    let selectedDate = new Date();

                switch (type) {
                    case 'yesterday':
                        selectedDate.setDate(today.getDate() - 1);
                        break;
                    case 'tomorrow':
                        selectedDate.setDate(today.getDate() + 1);
                        break;
                    default:
                        selectedDate = today;
                }

                datePicker.value = selectedDate.toISOString().split('T')[0];
                updateLunarInfo(selectedDate);
            }

                // Khởi tạo date picker với ngày hiện tại
                const datePicker = document.getElementById('datePicker');
                const today = new Date();
                datePicker.value = today.toISOString().split('T')[0];
                updateLunarInfo(today);

                // Xử lý sự kiện khi người dùng chọn ngày
                datePicker.addEventListener('change', (e) => {
                    const selectedDate = new Date(e.target.value);
                    updateLunarInfo(selectedDate);
            });

                // Thêm sự kiện click cho các nút chọn nhanh
                document.querySelectorAll('.quick-date-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const type = e.target.getAttribute('data-type');
                        setDate(type);
                });
            });
</script>
</body>
</html>